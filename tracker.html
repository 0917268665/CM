<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨‚å–®é€²åº¦è¿½è¹¤</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: #f4f4f9; padding: 20px; max-width: 600px; margin: 0 auto; }
        h2 { text-align: center; color: #333; }
        .card { background: white; border-radius: 12px; padding: 20px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); position: relative; overflow: hidden; }
        .card.done { border-left: 6px solid #2ecc71; }
        .card.pending { border-left: 6px solid #f1c40f; }
        
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .group-code { font-size: 1.2em; font-weight: bold; color: #2c3e50; }
        .agt { font-size: 0.9em; color: #7f8c8d; background: #ecf0f1; padding: 2px 8px; border-radius: 4px; }
        
        .status-badge { font-weight: bold; padding: 5px 10px; border-radius: 20px; font-size: 0.9em; display: inline-flex; align-items: center; }
        .status-done { background-color: #e8f8f5; color: #27ae60; }
        .status-pending { background-color: #fef9e7; color: #d4ac0d; }

        .details { margin-top: 10px; font-size: 0.9em; color: #555; }
        .missing-items { color: #e74c3c; margin-top: 5px; }
        .remark { margin-top: 8px; font-style: italic; color: #95a5a6; border-top: 1px solid #eee; padding-top: 5px; }
        
        .loading { text-align: center; padding: 20px; color: #666; }
        
        /* ç¶ è‰²å‹¾å‹¾å‹•ç•« */
        .check-icon::before { content: 'âœ“'; margin-right: 5px; }
    </style>
</head>
<body>

    <h2>ğŸ“‹ è¨‚å–®é€²åº¦è¿½è¹¤</h2>
    <div id="order-list">
        <div class="loading">æ­£åœ¨è¼‰å…¥è¨‚å–®è³‡æ–™...</div>
    </div>

<script>
    // â˜…â˜…â˜… è«‹åœ¨æ­¤è²¼ä¸Šæ‚¨çš„ Google Apps Script ç¶²å€ â˜…â˜…â˜…
    const GAS_URL = 'https://script.google.com/macros/s/AKfycby4PWsogyFH09g2Q3NtSeZbQrFI6by87s7Uh6dTBCSHqxCsyUIrhiDq8CkFMNDLg1Us/exec'; 

    fetch(GAS_URL)
    .then(res => res.json())
    .then(data => {
        const container = document.getElementById('order-list');
        container.innerHTML = ''; // æ¸…ç©ºè¼‰å…¥æ–‡å­—

        // åè½‰é™£åˆ—ï¼Œè®“æœ€æ–°çš„è¨‚å–®é¡¯ç¤ºåœ¨æœ€ä¸Šé¢
        data.reverse().forEach(order => {
            const card = document.createElement('div');
            
            if (order.isComplete) {
                // å®Œæˆç‹€æ…‹
                card.className = 'card done';
                card.innerHTML = `
                    <div class="header">
                        <span class="group-code">${order.groupCode}</span>
                        <span class="agt">${order.agt}</span>
                    </div>
                    <div class="status-badge status-done">
                        <span class="check-icon"></span> å·²å…¨æ•¸å®Œæˆ
                    </div>
                    ${order.remark ? `<div class="remark">å‚™è¨»: ${order.remark}</div>` : ''}
                `;
            } else {
                // é€²è¡Œä¸­ç‹€æ…‹
                card.className = 'card pending';
                const missingText = order.pending.join('ã€');
                card.innerHTML = `
                    <div class="header">
                        <span class="group-code">${order.groupCode}</span>
                        <span class="agt">${order.agt}</span>
                    </div>
                    <div class="status-badge status-pending">
                        é€²è¡Œä¸­
                    </div>
                    <div class="details">
                        <div class="missing-items">âš ï¸ å¾…å®Œæˆ: ${missingText}</div>
                    </div>
                    ${order.remark ? `<div class="remark">å‚™è¨»: ${order.remark}</div>` : ''}
                `;
            }
            container.appendChild(card);
        });
    })
    .catch(err => {
        document.getElementById('order-list').innerHTML = '<div style="color:red; text-align:center;">è®€å–å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯æˆ– Script è¨­å®š</div>';
        console.error(err);
    });
</script>

</body>
</html>